<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>é¸æ“‡å–è²¨é–€å¸‚</title>
  <style>
    body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
    select, button { padding: 8px; margin-top: 10px; }
    .note { font-size: 0.9em; color: #666; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>ğŸª é¸æ“‡è¶…å•†èˆ‡å–è²¨é–€å¸‚</h2>

  <label for="subType">è«‹é¸æ“‡è¶…å•†ï¼š</label>
  <select id="subType">
    <option value="FAMI">å…¨å®¶</option>
    <option value="UNIMART">7-ELEVEN</option>
    <option value="HILIFE">èŠçˆ¾å¯Œ</option>
  </select>

  <br />
  <button id="openMap">ğŸ“ é–‹å•Ÿé–€å¸‚åœ°åœ–</button>

  <p class="note">ğŸ‘‰ é¸æ“‡é–€å¸‚å¾Œå°‡è·³å›ç‰©æµè¨‚å–®é ï¼Œä¸¦è‡ªå‹•å¸¶å…¥é–€å¸‚è³‡è¨Š</p>

  <script>
    document.getElementById('openMap').addEventListener('click', () => {
      const subType = document.getElementById('subType').value;
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = 'https://logistics-stage.ecpay.com.tw/Express/map';
      form.target = '_blank';

      const now = Date.now();

      const clientReplyUrl = `https://chunzhi-care.onrender.com/logistics-test.html?subtype=${subType}`;

      const fields = {
        MerchantID: '2000132',
        MerchantTradeNo: 'MAP' + now,
        LogisticsType: 'CVS',
        LogisticsSubType: subType,
        IsCollection: 'N',
        ServerReplyURL: 'https://chunzhi-care.onrender.com/api/logistics/cvs-store-reply',
        ClientReplyURL: clientReplyUrl
      };

      Object.entries(fields).forEach(([key, val]) => {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = val;
        form.appendChild(input);
      });

      document.body.appendChild(form);
      form.submit();
      document.body.removeChild(form);
    });
  </script>
</body>
</html>