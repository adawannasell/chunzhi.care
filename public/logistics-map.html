<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>é¸æ“‡è¶…å•†é–€å¸‚</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; }
  </style>
</head>
<body class="bg-[#fdfaf5] text-[#1a1a1a] px-4 py-12">
  <div class="max-w-xl mx-auto bg-white shadow rounded p-6">
    <h1 class="text-xl font-bold mb-4 text-center">ğŸª é¸æ“‡å–è²¨é–€å¸‚</h1>
    <p class="mb-6 text-sm text-gray-700">è«‹é»é¸ä¸‹æ–¹æŒ‰éˆ•é–‹å•Ÿç¶ ç•Œåœ°åœ–ï¼Œé¸æ“‡æ‚¨æƒ³å–è²¨çš„è¶…å•†é–€å¸‚ã€‚</p>

    <button id="open-map" class="w-full bg-green-700 text-white py-3 rounded font-semibold hover:bg-green-800 transition">
      é–‹å•Ÿé–€å¸‚é¸æ“‡åœ°åœ–
    </button>

    <div id="result" class="mt-6 text-sm text-gray-800 space-y-1"></div>
  </div>

  <script>
    document.getElementById('open-map').addEventListener('click', () => {
      const url = `https://logistics-stage.ecpay.com.tw/Express/map` +
        `?MerchantID=2000132` +  // æ¸¬è©¦å¸³è™Ÿå›ºå®šå¯«æ­»
        `&LogisticsType=CVS` +
        `&LogisticsSubType=OKMart` +
        `&IsCollection=NO` +
        `&ServerReplyURL=${encodeURIComponent(window.location.origin + '/logistics-map-reply.html')}`;

      window.open(url, 'ecpayMapWindow', 'width=500,height=600');
    });

    // æ¥æ”¶é¸å®Œé–€å¸‚çš„è³‡æ–™
    window.addEventListener('message', function (e) {
      if (typeof e.data === 'string' && e.data.includes('CVSStoreID')) {
        const params = new URLSearchParams(e.data);
        const storeInfo = {
          åº—å: params.get('CVSStoreName'),
          åœ°å€: params.get('CVSAddress'),
          é–€å¸‚ä»£ç¢¼: params.get('CVSStoreID')
        };

        const output = Object.entries(storeInfo).map(([k, v]) => `<div><strong>${k}ï¼š</strong>${v}</div>`).join('');
        document.getElementById('result').innerHTML = output;
      }
    }, false);
  </script>
</body>
</html>